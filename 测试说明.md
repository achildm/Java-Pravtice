# 登录问题修复说明

## 修复的问题

### 1. 头像选择问题 ✅
- **问题**: 点击头像无法更换显示的头像
- **修复**: 
  - 添加了独立的 `selectedAvatarLabel` 来显示选中的头像
  - 在 `selectAvatar` 方法中更新显示标签
  - 添加了调试信息来跟踪头像选择

### 2. 连接无反应问题 ✅
- **问题**: 点击连接按钮没有反应
- **修复**:
  - 添加了详细的错误提示信息
  - 改进了异常处理，显示具体的连接失败原因
  - 添加了调试信息来跟踪连接过程
  - 默认服务器地址改为 `localhost`，更容易测试

## 测试步骤

### 第一步：启动服务器
```bash
# 在第一个命令行窗口中运行
java -cp target/classes com.achldm.chess.ChessGameMain server
```

你应该看到：
```
游戏服务器启动，监听端口: 8888
```

### 第二步：启动客户端
```bash
# 在第二个命令行窗口中运行
java -cp target/classes com.achldm.chess.ChessGameMain
```

### 第三步：测试头像选择
1. 在登录界面中，点击不同的头像
2. 观察右上角的头像显示是否会更新
3. 控制台会输出 "选择了头像: X" 的调试信息

### 第四步：测试连接功能
1. 输入用户名（例如：玩家1）
2. 服务器地址保持默认的 `localhost`
3. 点击"连接"按钮
4. 如果服务器未启动，会显示详细的错误信息
5. 如果连接成功，会进入游戏大厅

## 调试信息

修复后的代码会在控制台输出以下调试信息：
- `选择了头像: X` - 当选择头像时
- `尝试连接服务器: host:port` - 开始连接时
- `登录消息已发送` - 消息发送成功时
- `连接失败: 错误信息` - 连接失败时
- `登录成功，打开大厅界面` - 登录成功时
- `登录失败: 错误信息` - 登录失败时

## 常见问题解决

### 1. 头像不显示
- 检查 `src/main/resources/face/` 文件夹中是否有头像文件
- 确保文件名格式为 `1-1.gif`, `2-1.gif` 等

### 2. 连接服务器失败
- 确保先启动服务器再启动客户端
- 检查端口8888是否被其他程序占用
- 确认防火墙设置允许本地连接

### 3. 服务器启动失败
- 检查端口8888是否已被占用
- 尝试以管理员权限运行

## 快速测试脚本

创建两个批处理文件方便测试：

**start-server-test.bat**:
```batch
@echo off
echo 启动测试服务器...
java -cp target/classes com.achldm.chess.ChessGameMain server
pause
```

**start-client-test.bat**:
```batch
@echo off
echo 启动测试客户端...
java -cp target/classes com.achldm.chess.ChessGameMain
pause
```

## 验证修复效果

1. **头像选择**: 点击不同头像，右上角显示应该立即更新
2. **连接功能**: 
   - 无服务器时显示详细错误信息
   - 有服务器时成功进入大厅
3. **用户体验**: 所有操作都有明确的反馈信息

修复后的登录界面现在应该完全正常工作了！